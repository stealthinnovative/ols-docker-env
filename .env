# ==============================================================================
# WP-STACK: RYZEN 7900X / 4GB RAM / NVME
# ==============================================================================

TIMEZONE=Pacific/Honolulu
DOMAIN=yourdomain.com
EMAIL=admin@yourdomain.com

# --- Database Security ---
MYSQL_ROOT_PASSWORD=complex_root_password
MYSQL_DATABASE=wordpress
MYSQL_USER=wp_user
MYSQL_PASSWORD=complex_app_password

# --- Docker Images & PHP Version Control ---
# ðŸš€ Pinned high-performance LSPHP 8.5 build
LITESPEED_IMAGE=litespeedtech/openlitespeed:1.8.5-lsphp85
MARIADB_IMAGE=mariadb:lts-noble
REDIS_IMAGE=redis:alpine

# ==============================================================================
# PERFORMANCE TUNING (Scalability Guide)
# ==============================================================================

# --- Host Memory & Zswap ---
# Recommended ZSWAP / Swap Size per server RAM:
# 2GB server: ZSWAP_MAX_PERCENT=25, HOST_SWAP_SIZE=1G
# 4GB server: ZSWAP_MAX_PERCENT=38, HOST_SWAP_SIZE=2G
# 8GB server: ZSWAP_MAX_PERCENT=45, HOST_SWAP_SIZE=4G
ZSWAP_MAX_PERCENT=38
HOST_SWAP_SIZE=2G

# --- Container Resource Limits ---
# OpenLiteSpeed Memory Limits
# Recommended per server RAM with Zswap Enabled
# 2GB: OLS_MEM_LIMIT=1G, OLS_TOTAL_LIMIT=1.5G
# 4GB: OLS_MEM_LIMIT=2G, OLS_TOTAL_LIMIT=3.8G
# 8GB: OLS_MEM_LIMIT=5G, OLS_TOTAL_LIMIT=10G
OLS_MEM_LIMIT=3.8G

# ==============================================================================
# MariaDB: Set BOTH values per server size
# ==============================================================================
# 2GB server: 512M container â†’ 128M InnoDB  
# 4GB server: 768M container â†’ 512M InnoDB
# 8GB server: 1536M container â†’ 1G InnoDB
DB_MEM_LIMIT=768M
DB_BUFFER_POOL=512M

DB_LOG_FILE=128M
DB_FLUSH_COMMIT=2

# Max Connections:
# 2GB: 100 | 4GB: 151 | 8GB: 300+
MARIADB_MAX_CONNS=151

# --- OpenLiteSpeed & PHP Workers ---
# PHP Workers / LSAPI Children per server RAM:
# 2GB: 8 | 4GB: 24 | 8GB: 48+
PHP_WORKERS=24
OLS_WORKERS=1
CPU_AFFINITY=1

# --- PHP Application Limits ---
PHP_MEMORY_LIMIT=256M
PHP_MAX_EXECUTION_TIME=60
PHP_UPLOAD_MAX_FILESIZE=512M
PHP_POST_MAX_SIZE=512M

# ==============================================================================
# REDIS CONFIGURATION (Dual-Mode Support)
# ==============================================================================
# REDIS_MAX_MEMORY=64mb - Must be changed at REDIS_COMMAND
REDIS_MEM_LIMIT=128M

# --- Redis Mode Selection ---
# Option 1: SOCKET ONLY (Default, best performance)
#REDIS_COMMAND="--port 0 --unixsocket /var/run/redis/redis.sock --unixsocketperm 777 --maxmemory 64mb --maxmemory-policy allkeys-lru"

# Option 2: SOCKET + TCP (uncomment to enable TCP for RedisInsight or debugging)
REDIS_COMMAND="REDIS_COMMAND="--port 0 --unixsocket /var/run/redis/redis.sock --unixsocketperm 777 --maxmemory 64mb --maxmemory-policy allkeys-lru""

# ==============================================================================
# POST-INSTALL SETUP GUIDE
# ==============================================================================
# 1. Run Host Optimizer: sudo ./bin/zswap-enable
# 2. WP LSCache Plugin Redis config: Host = /var/run/redis/redis.sock | Port = 0 (unless TCP enabled)
# 3. Multi-site LSCache: Use unique "Global Key Prefix" per site, e.g. site1_
# ==============================================================================
